# ReadFish 📚

一个专为上班摸鱼设计的轻量级文本阅读器，支持无边框窗口、透明度调节、书架管理等功能。

## ✨ 功能特性

### 📖 阅读功能
- **智能编码检测**: 自动识别文件编码（UTF-8、GBK、GB2312等）
- **双显示模式**: 支持单行和多行显示模式切换
- **翻页功能**: 上下翻页、长行智能分页
- **阅读历史**: 自动保存阅读进度，支持继续阅读
- **章节目录**: 智能识别章节结构，快速跳转
- **无边框窗口**: 阅读时使用无边框窗口，更加隐蔽
- **窗口拖动**: 可以随意拖动阅读窗口到任意位置

### 📚 书架管理
- **书籍导入**: 将txt文件导入到个人书架
- **书籍管理**: 重命名、删除书架中的书籍
- **继续阅读**: 从上次阅读位置继续
- **从头阅读**: 重新开始阅读书籍
- **阅读统计**: 显示阅读进度和时间

### 🎯 目录功能
- **智能解析**: 自动识别多种章节格式（《第X章》、【第X章】、第X章等）
- **目录预览**: 显示完整的章节列表
- **快速跳转**: 双击章节直接跳转到对应位置
- **章节搜索**: 在目录中搜索特定章节

### ⚙️ 配置功能
- **窗口设置**:
  - 自定义窗口大小和位置
  - 置顶显示控制
  - 悬停显示模式
  - 按键显示控制

- **文字设置**:
  - 多种字体选择（微软雅黑、宋体、黑体、楷体等）
  - 字体大小调节（1pt - 72pt）
  - 文字颜色自定义
  - 文字透明度调节（10% - 100%）

- **显示控制**:
  - 四角调节大小标记
  - 自定义按键控制（Ctrl、Alt、Shift等）
  - 配置自动保存

### 🎮 操作方式
- **左键拖动**: 移动窗口位置
- **右键菜单**: 访问配置和其他功能
- **ESC键**: 快速关闭阅读窗口
- **Ctrl+Q**: 退出应用程序
- **滚轮**: 翻页操作
- **双击**: 章节跳转（在目录中）

## 安装和使用

### 环境要求
- Python 3.6 或更高版本
- Windows 操作系统

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行程序
```bash
python main.py
```

## 📖 使用说明

### 1. 启动程序
运行 `main.py` 后会显示主窗口，包含书架管理和文件选择功能。

### 2. 书架管理
**导入书籍**：
- 点击「导入书籍」按钮，选择要添加的 txt 文件
- 书籍会自动复制到书架目录并显示在书架列表中

**管理书籍**：
- **继续阅读**: 从上次阅读位置继续
- **从头阅读**: 重新开始阅读
- **重命名**: 修改书籍在书架中的显示名称
- **删除**: 从书架中移除书籍
- **查看目录**: 预览书籍的章节结构

### 3. 直接阅读
**选择文件**：
- 点击「选择文件」按钮，选择要阅读的 txt 文件
- 程序支持多种编码格式的自动识别

**开始阅读**：
- 选择文件后，点击「开始阅读」按钮
- 主窗口会自动隐藏，显示无边框的阅读窗口

### 4. 阅读操作
**基本操作**：
- **拖动窗口**: 左键拖动移动位置
- **翻页**: 使用滚轮翻页
- **模式切换**: 在单行和多行显示模式间切换
- **快速退出**: 按ESC键快速关闭阅读窗口

**目录功能**：
- 右键菜单选择「查看目录」
- 在目录窗口中双击章节名称快速跳转
- 支持章节搜索功能

### 5. 配置设置
在阅读窗口中右键点击，选择「配置设置」：

**窗口设置**：
- 调整窗口大小、位置
- 设置置顶显示和悬停模式
- 控制按键和调节标记的显示

**文字设置**：
- 修改字体、大小、颜色和透明度
- 实时预览配置效果
- 设置会自动保存

### 6. 其他功能
右键菜单还提供：
- **保持置顶**: 切换窗口置顶状态
- **返回主窗口**: 回到书架管理界面
- **查看目录**: 显示章节目录
- **退出**: 关闭程序


## ⚙️ 配置文件

程序会在用户AppData目录下自动创建配置和数据文件：
- **配置文件**：`%APPDATA%\ReadFish\config.json` - 存储窗口和文字设置
- **书架数据**：`%APPDATA%\ReadFish\bookshelf.json` - 存储书架中的书籍信息
- **阅读历史**：`%APPDATA%\ReadFish\reading_history.json` - 存储阅读进度和历史
- **书籍文件**：`%APPDATA%\ReadFish\book\` - 存储导入的书籍文件

### 配置文件详解

**窗口设置**：
```json
{
    "window_width": 400,           // 窗口宽度
    "window_height": 300,          // 窗口高度
    "window_x": 100,               // 窗口X坐标
    "window_y": 100,               // 窗口Y坐标
    "window_opacity": 0.9,         // 窗口透明度
    "stay_on_top": true,           // 保持置顶
    "auto_save_position": true,    // 自动保存位置
    "show_on_hover": false,        // 悬停显示
    "show_resize_handles": true,   // 显示调节标记
    "show_key_display": true       // 显示按键提示
}
```

**文字设置**：
```json
{
    "font_family": "Microsoft YaHei", // 字体
    "font_size": 12,                  // 字体大小
    "font_color": "#000000",          // 文字颜色
    "text_opacity": 1.0               // 文字透明度
}
```

**显示设置**：
```json
{
    "display_mode": "single_line",    // 显示模式（single_line/multi_line）
    "key_combination": "ctrl"         // 按键组合（ctrl/alt/shift/none）
}
```

## 🐟 摸鱼技巧

### 隐蔽性设置
1. **背景透明**: 调整窗口透明度，只显示文字内容
2. **小窗口模式**: 设置较小的窗口尺寸，放在屏幕角落或任务栏附近
3. **悬停显示**: 开启悬停模式，鼠标移开时窗口自动隐藏
4. **合适的字体**: 选择与工作环境相似的字体和颜色
5. **单行模式**: 使用单行显示，看起来像代码或工作内容

### 快捷操作
1. **ESC快速关闭**: 熟练使用ESC键瞬间关闭阅读窗口
2. **按键控制**: 设置Ctrl/Alt/Shift组合键控制显示
3. **位置记忆**: 程序自动记住窗口位置，下次打开恢复
4. **书架管理**: 提前导入书籍，避免临时选择文件
5. **继续阅读**: 自动保存进度，随时继续上次阅读

### 高级技巧
1. **目录跳转**: 使用目录功能快速跳转到感兴趣的章节
2. **多书管理**: 在书架中准备多本书籍，随时切换
3. **配置预设**: 为不同场景准备不同的显示配置

## ⚠️ 注意事项

- 目前仅支持 txt 格式的文本文件
- 支持多种编码格式的自动识别（UTF-8、GBK、GB2312等）
- 配置和数据文件保存在用户AppData目录，不会影响项目代码
- 书籍文件会复制到程序目录，原文件不受影响
- 请合理使用，注意工作效率和公司规章制度

## 🚀 开发计划

### 已完成功能
- [x] 智能编码检测
- [x] 书架管理系统
- [x] 阅读历史和进度保存
- [x] 章节目录解析和跳转
- [x] 双显示模式（单行/多行）
- [x] 配置文件迁移到用户数据目录
- [x] 悬停显示和按键控制

### 计划中功能
- [ ] 支持更多文本格式（epub、pdf等）
- [ ] 添加书签功能
- [ ] 夜间模式和主题切换
- [ ] 自动翻页功能
- [ ] 全文搜索功能
- [ ] 阅读统计和分析
- [ ] 云同步功能
- [ ] 插件系统

## 📁 项目结构

```
ReadFish/
├── main.py                 # 主程序入口
├── config_manager.py       # 配置管理模块
├── history_manager.py      # 历史记录管理
├── file_utils.py          # 文件工具模块
├── book_item_widget.py    # 书籍项目组件
├── contents_window.py     # 目录窗口
├── migrate_data.py        # 数据迁移脚本
├── requirements.txt       # 依赖包列表
├── README.md             # 项目说明文档
└── .gitignore            # Git忽略文件
```

## 🔄 数据迁移

如果你是从旧版本升级，可以使用提供的迁移脚本：

```bash
python migrate_data.py
```

该脚本会自动将以下文件从项目目录迁移到AppData目录：
- `config.json` → `%APPDATA%\ReadFish\config.json`
- `bookshelf.json` → `%APPDATA%\ReadFish\bookshelf.json`
- `reading_history.json` → `%APPDATA%\ReadFish\reading_history.json`
- `book/` → `%APPDATA%\ReadFish\book\`

迁移完成后，旧文件可以安全删除。

## 📄 许可证

本项目仅供学习和个人使用，请合理使用，注意工作效率。

---

**免责声明**: 本工具仅供学习交流使用，使用者需自行承担使用风险，开发者不对因使用本工具导致的任何后果负责。请在遵守公司规章制度的前提下合理使用。